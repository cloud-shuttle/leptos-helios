<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helios Phase 5B: Advanced Theming & Analytics Showcase</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .showcase-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .showcase-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .showcase-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .showcase-card h2 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.8rem;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .theme-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
        }

        .control-group label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #4a5568;
        }

        .control-group input,
        .control-group select {
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .control-group input:focus,
        .control-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .analytics-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .chart-container {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #e2e8f0;
        }

        .chart-canvas {
            width: 100%;
            height: 300px;
            border: 1px solid #cbd5e0;
            border-radius: 8px;
            background: white;
        }

        .analytics-results {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }

        .analytics-results h3 {
            color: #4a5568;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .metric-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.9rem;
            color: #718096;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .theme-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .theme-color {
            height: 60px;
            border-radius: 8px;
            border: 2px solid #e2e8f0;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .theme-color:hover {
            transform: scale(1.05);
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-success { background-color: #48bb78; }
        .status-warning { background-color: #ed8936; }
        .status-error { background-color: #f56565; }

        .log-container {
            background: #1a202c;
            color: #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin: 20px 0;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }

        .log-timestamp {
            color: #a0aec0;
        }

        .log-level-info { color: #63b3ed; }
        .log-level-warn { color: #f6e05e; }
        .log-level-error { color: #fc8181; }

        .responsive-demo {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .breakpoint-indicator {
            background: #edf2f7;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            font-size: 0.9rem;
            color: #4a5568;
        }

        .breakpoint-active {
            background: #667eea;
            color: white;
        }

        @media (max-width: 768px) {
            .showcase-grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2rem;
            }

            .theme-controls,
            .analytics-controls {
                grid-template-columns: 1fr;
            }
        }

        .animation-demo {
            margin: 20px 0;
        }

        .animated-element {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            margin: 20px auto;
            transition: all 0.5s ease;
        }

        .animated-element:hover {
            transform: scale(1.2) rotate(180deg);
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .performance-metrics {
            background: #f0fff4;
            border: 1px solid #9ae6b4;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .performance-metrics h4 {
            color: #22543d;
            margin-bottom: 10px;
        }

        .performance-bar {
            background: #e2e8f0;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin: 5px 0;
        }

        .performance-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78, #38a169);
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸš€ Helios Phase 5B Showcase</h1>
            <p>Advanced Theming & Analytics Capabilities</p>
        </div>

        <div class="showcase-grid">
            <!-- Advanced Theming Showcase -->
            <div class="showcase-card">
                <h2>ðŸŽ¨ Advanced Theming System</h2>

                <div class="theme-controls">
                    <div class="control-group">
                        <label for="theme-select">Theme Preset</label>
                        <select id="theme-select" onchange="applyThemePreset()">
                            <option value="default">Default</option>
                            <option value="dark">Dark Mode</option>
                            <option value="ocean">Ocean Blue</option>
                            <option value="sunset">Sunset Orange</option>
                            <option value="forest">Forest Green</option>
                            <option value="custom">Custom</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label for="primary-color">Primary Color</label>
                        <input type="color" id="primary-color" value="#667eea" onchange="updateTheme()">
                    </div>

                    <div class="control-group">
                        <label for="secondary-color">Secondary Color</label>
                        <input type="color" id="secondary-color" value="#764ba2" onchange="updateTheme()">
                    </div>

                    <div class="control-group">
                        <label for="font-family">Font Family</label>
                        <select id="font-family" onchange="updateTheme()">
                            <option value="'Segoe UI', sans-serif">Segoe UI</option>
                            <option value="'Roboto', sans-serif">Roboto</option>
                            <option value="'Inter', sans-serif">Inter</option>
                            <option value="'Poppins', sans-serif">Poppins</option>
                        </select>
                    </div>
                </div>

                <div class="theme-preview">
                    <div class="theme-color" style="background: #667eea;" title="Primary"></div>
                    <div class="theme-color" style="background: #764ba2;" title="Secondary"></div>
                    <div class="theme-color" style="background: #f093fb;" title="Accent"></div>
                    <div class="theme-color" style="background: #f5576c;" title="Warning"></div>
                    <div class="theme-color" style="background: #4facfe;" title="Info"></div>
                    <div class="theme-color" style="background: #00f2fe;" title="Success"></div>
                </div>

                <div class="animation-demo">
                    <h4>Animation Engine Demo</h4>
                    <div class="animated-element" onclick="triggerAnimation()"></div>
                    <button class="btn" onclick="triggerAnimation()">Trigger Animation</button>
                </div>

                <div class="responsive-demo">
                    <h4>Responsive Design</h4>
                    <div class="breakpoint-indicator" id="breakpoint-xs">XS: <span id="xs-status">âœ“</span></div>
                    <div class="breakpoint-indicator" id="breakpoint-sm">SM: <span id="sm-status">âœ“</span></div>
                    <div class="breakpoint-indicator" id="breakpoint-md">MD: <span id="md-status">âœ“</span></div>
                    <div class="breakpoint-indicator" id="breakpoint-lg">LG: <span id="lg-status">âœ“</span></div>
                    <div class="breakpoint-indicator" id="breakpoint-xl">XL: <span id="xl-status">âœ“</span></div>
                </div>

                <div class="chart-container">
                    <h4>Themed Chart Example</h4>
                    <canvas id="themed-chart" class="chart-canvas"></canvas>
                </div>
            </div>

            <!-- Advanced Analytics Showcase -->
            <div class="showcase-card">
                <h2>ðŸ“Š Advanced Analytics Engine</h2>

                <div class="analytics-controls">
                    <div class="control-group">
                        <label for="data-size">Data Size</label>
                        <select id="data-size" onchange="updateAnalytics()">
                            <option value="100">100 points</option>
                            <option value="1000">1K points</option>
                            <option value="10000">10K points</option>
                            <option value="100000">100K points</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label for="analysis-type">Analysis Type</label>
                        <select id="analysis-type" onchange="updateAnalytics()">
                            <option value="descriptive">Descriptive Stats</option>
                            <option value="time-series">Time Series</option>
                            <option value="anomaly">Anomaly Detection</option>
                            <option value="forecasting">Forecasting</option>
                        </select>
                    </div>
                </div>

                <div class="analytics-controls">
                    <button class="btn" onclick="runAnalytics()">Run Analysis</button>
                    <button class="btn btn-secondary" onclick="generateData()">Generate Data</button>
                    <button class="btn btn-success" onclick="exportResults()">Export Results</button>
                </div>

                <div class="analytics-results" id="analytics-results">
                    <h3>Analytics Results</h3>
                    <div class="metric-grid" id="metric-grid">
                        <div class="metric-card">
                            <div class="metric-value" id="mean-value">0.00</div>
                            <div class="metric-label">Mean</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="std-value">0.00</div>
                            <div class="metric-label">Std Dev</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="anomaly-count">0</div>
                            <div class="metric-label">Anomalies</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="forecast-accuracy">0%</div>
                            <div class="metric-label">Accuracy</div>
                        </div>
                    </div>
                </div>

                <div class="performance-metrics">
                    <h4>Performance Metrics</h4>
                    <div>
                        <label>Processing Time: <span id="processing-time">0ms</span></label>
                        <div class="performance-bar">
                            <div class="performance-fill" id="processing-bar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div>
                        <label>Memory Usage: <span id="memory-usage">0MB</span></label>
                        <div class="performance-bar">
                            <div class="performance-fill" id="memory-bar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div>
                        <label>CPU Usage: <span id="cpu-usage">0%</span></label>
                        <div class="performance-bar">
                            <div class="performance-fill" id="cpu-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <div class="chart-container">
                    <h4>Analytics Visualization</h4>
                    <canvas id="analytics-chart" class="chart-canvas"></canvas>
                </div>
            </div>
        </div>

        <!-- System Status -->
        <div class="showcase-card">
            <h2>ðŸ”§ System Status & Logs</h2>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px;">
                <div>
                    <h4>Theme Engine</h4>
                    <p><span class="status-indicator status-success"></span>Active</p>
                    <p><span class="status-indicator status-success"></span>CSS-in-Rust: Enabled</p>
                    <p><span class="status-indicator status-success"></span>Animation Engine: Ready</p>
                </div>

                <div>
                    <h4>Analytics Engine</h4>
                    <p><span class="status-indicator status-success"></span>ML Pipeline: Ready</p>
                    <p><span class="status-indicator status-success"></span>Statistical Analyzer: Active</p>
                    <p><span class="status-indicator status-success"></span>Anomaly Detection: Monitoring</p>
                </div>

                <div>
                    <h4>Performance</h4>
                    <p><span class="status-indicator status-success"></span>Memory: <span id="system-memory">45MB</span></p>
                    <p><span class="status-indicator status-success"></span>CPU: <span id="system-cpu">12%</span></p>
                    <p><span class="status-indicator status-success"></span>GPU: <span id="system-gpu">8%</span></p>
                </div>
            </div>

            <div class="log-container" id="log-container">
                <div class="log-entry">
                    <span class="log-timestamp">[12:34:56]</span>
                    <span class="log-level-info">[INFO]</span> Helios Phase 5B showcase initialized
                </div>
                <div class="log-entry">
                    <span class="log-timestamp">[12:34:57]</span>
                    <span class="log-level-info">[INFO]</span> Theme engine loaded with 6 presets
                </div>
                <div class="log-entry">
                    <span class="log-timestamp">[12:34:58]</span>
                    <span class="log-level-info">[INFO]</span> Analytics engine ready with 4 algorithms
                </div>
                <div class="log-entry">
                    <span class="log-timestamp">[12:34:59]</span>
                    <span class="log-level-info">[INFO]</span> Performance monitoring active
                </div>
            </div>
        </div>
    </div>

    <script>
        // Theme Engine Demo
        let currentTheme = 'default';
        let animationFrame = 0;

        const themes = {
            default: {
                primary: '#667eea',
                secondary: '#764ba2',
                accent: '#f093fb',
                warning: '#f5576c',
                info: '#4facfe',
                success: '#00f2fe'
            },
            dark: {
                primary: '#2d3748',
                secondary: '#4a5568',
                accent: '#805ad5',
                warning: '#dd6b20',
                info: '#3182ce',
                success: '#38a169'
            },
            ocean: {
                primary: '#0ea5e9',
                secondary: '#0284c7',
                accent: '#06b6d4',
                warning: '#f59e0b',
                info: '#3b82f6',
                success: '#10b981'
            },
            sunset: {
                primary: '#f97316',
                secondary: '#ea580c',
                accent: '#f59e0b',
                warning: '#ef4444',
                info: '#8b5cf6',
                success: '#22c55e'
            },
            forest: {
                primary: '#16a34a',
                secondary: '#15803d',
                accent: '#84cc16',
                warning: '#eab308',
                info: '#0ea5e9',
                success: '#22c55e'
            }
        };

        function applyThemePreset() {
            const preset = document.getElementById('theme-select').value;
            currentTheme = preset;

            if (preset !== 'custom') {
                const theme = themes[preset];
                document.getElementById('primary-color').value = theme.primary;
                document.getElementById('secondary-color').value = theme.secondary;
                updateTheme();
            }

            logMessage(`Applied theme preset: ${preset}`, 'info');
        }

        function updateTheme() {
            const primary = document.getElementById('primary-color').value;
            const secondary = document.getElementById('secondary-color').value;
            const fontFamily = document.getElementById('font-family').value;

            // Update CSS custom properties
            document.documentElement.style.setProperty('--primary-color', primary);
            document.documentElement.style.setProperty('--secondary-color', secondary);
            document.documentElement.style.setProperty('--font-family', fontFamily);

            // Update theme preview colors
            const themeColors = document.querySelectorAll('.theme-color');
            themeColors[0].style.background = primary;
            themeColors[1].style.background = secondary;

            // Update chart colors
            updateChartColors(primary, secondary);

            logMessage(`Theme updated: Primary=${primary}, Secondary=${secondary}`, 'info');
        }

        function triggerAnimation() {
            const element = document.querySelector('.animated-element');
            element.style.animation = 'none';
            element.offsetHeight; // Trigger reflow
            element.style.animation = 'pulse 0.5s ease-in-out';

            logMessage('Animation triggered', 'info');
        }

        function updateResponsiveBreakpoints() {
            const width = window.innerWidth;
            const breakpoints = {
                xs: width < 576,
                sm: width >= 576 && width < 768,
                md: width >= 768 && width < 992,
                lg: width >= 992 && width < 1200,
                xl: width >= 1200
            };

            Object.keys(breakpoints).forEach(bp => {
                const indicator = document.getElementById(`breakpoint-${bp}`);
                const status = document.getElementById(`${bp}-status`);

                if (breakpoints[bp]) {
                    indicator.classList.add('breakpoint-active');
                    status.textContent = 'âœ“';
                } else {
                    indicator.classList.remove('breakpoint-active');
                    status.textContent = 'â—‹';
                }
            });
        }

        // Analytics Engine Demo
        let analyticsData = [];
        let analyticsResults = {};

        function generateData() {
            const size = parseInt(document.getElementById('data-size').value);
            analyticsData = [];

            for (let i = 0; i < size; i++) {
                // Create more interesting data patterns
                const trend = i * 0.15; // Stronger trend
                const seasonal = Math.sin(i * 0.1) * 2.0; // More pronounced seasonality
                const noise = (Math.random() - 0.5) * 0.8; // More noise
                const cycle = Math.sin(i * 0.05) * 1.5; // Long-term cycle

                // Add some random spikes for anomalies
                const anomaly = Math.random() < 0.03 ? (Math.random() - 0.5) * 8 : 0;

                const value = trend + seasonal + noise + cycle + anomaly;

                analyticsData.push({
                    x: i,
                    y: value,
                    isAnomaly: anomaly !== 0
                });
            }

            logMessage(`Generated ${size} data points with enhanced patterns`, 'info');

            // Force chart update with a small delay to ensure data is ready
            setTimeout(() => {
                updateAnalyticsChart();
            }, 50);
        }

        function runAnalytics() {
            const startTime = performance.now();
            const analysisType = document.getElementById('analysis-type').value;

            // Simulate analytics processing
            setTimeout(() => {
                const endTime = performance.now();
                const processingTime = endTime - startTime;

                switch (analysisType) {
                    case 'descriptive':
                        runDescriptiveAnalysis();
                        break;
                    case 'time-series':
                        runTimeSeriesAnalysis();
                        break;
                    case 'anomaly':
                        runAnomalyDetection();
                        break;
                    case 'forecasting':
                        runForecasting();
                        break;
                }

                updatePerformanceMetrics(processingTime);
                logMessage(`${analysisType} analysis completed in ${processingTime.toFixed(2)}ms`, 'info');
            }, Math.random() * 100 + 50);
        }

        function runDescriptiveAnalysis() {
            if (analyticsData.length === 0) return;

            const values = analyticsData.map(d => d.y);
            const mean = values.reduce((a, b) => a + b, 0) / values.length;
            const variance = values.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / values.length;
            const stdDev = Math.sqrt(variance);

            document.getElementById('mean-value').textContent = mean.toFixed(2);
            document.getElementById('std-value').textContent = stdDev.toFixed(2);

            analyticsResults = { mean, stdDev, variance };
        }

        function runTimeSeriesAnalysis() {
            if (analyticsData.length === 0) return;

            // Simulate time series analysis
            const trend = 0.85;
            const seasonality = 0.42;
            const stationarity = 0.73;

            document.getElementById('mean-value').textContent = trend.toFixed(2);
            document.getElementById('std-value').textContent = seasonality.toFixed(2);
            document.getElementById('anomaly-count').textContent = Math.floor(Math.random() * 10);
            document.getElementById('forecast-accuracy').textContent = '87%';
        }

        function runAnomalyDetection() {
            if (analyticsData.length === 0) return;

            const anomalies = analyticsData.filter(d => d.isAnomaly).length;
            const anomalyRate = (anomalies / analyticsData.length) * 100;

            document.getElementById('anomaly-count').textContent = anomalies;
            document.getElementById('forecast-accuracy').textContent = `${anomalyRate.toFixed(1)}%`;

            // Highlight anomalies in chart
            updateAnalyticsChart();
        }

        function runForecasting() {
            if (analyticsData.length === 0) return;

            // Simulate forecasting
            const accuracy = 85 + Math.random() * 10;
            const forecast = analyticsData.slice(-10).map(d => d.y + Math.random() * 0.5);

            document.getElementById('forecast-accuracy').textContent = `${accuracy.toFixed(1)}%`;
            document.getElementById('mean-value').textContent = forecast[0].toFixed(2);
            document.getElementById('std-value').textContent = forecast[forecast.length - 1].toFixed(2);
        }

        function updatePerformanceMetrics(processingTime) {
            const memoryUsage = 20 + Math.random() * 30;
            const cpuUsage = 10 + Math.random() * 20;

            document.getElementById('processing-time').textContent = `${processingTime.toFixed(2)}ms`;
            document.getElementById('memory-usage').textContent = `${memoryUsage.toFixed(1)}MB`;
            document.getElementById('cpu-usage').textContent = `${cpuUsage.toFixed(1)}%`;

            document.getElementById('processing-bar').style.width = `${Math.min(processingTime / 10, 100)}%`;
            document.getElementById('memory-bar').style.width = `${Math.min(memoryUsage / 2, 100)}%`;
            document.getElementById('cpu-bar').style.width = `${Math.min(cpuUsage, 100)}%`;
        }

        function updateAnalytics() {
            generateData();
            // Force chart update after data generation
            setTimeout(() => {
                updateAnalyticsChart();
            }, 100);
        }

        function exportResults() {
            const results = {
                timestamp: new Date().toISOString(),
                dataSize: analyticsData.length,
                analysisType: document.getElementById('analysis-type').value,
                results: analyticsResults,
                performance: {
                    processingTime: document.getElementById('processing-time').textContent,
                    memoryUsage: document.getElementById('memory-usage').textContent,
                    cpuUsage: document.getElementById('cpu-usage').textContent
                }
            };

            const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `helios-analytics-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);

            logMessage('Analytics results exported', 'info');
        }

        // Chart Functions
        function updateChartColors(primary, secondary) {
            // Update themed chart
            const themedCanvas = document.getElementById('themed-chart');
            const themedCtx = themedCanvas.getContext('2d');

            // Clear and redraw with new colors
            themedCtx.clearRect(0, 0, themedCanvas.width, themedCanvas.height);
            drawThemedChart(themedCtx, primary, secondary);
        }

        function drawThemedChart(ctx, primary, secondary) {
            const width = ctx.canvas.width;
            const height = ctx.canvas.height;

            // Draw gradient background
            const gradient = ctx.createLinearGradient(0, 0, width, height);
            gradient.addColorStop(0, primary + '20');
            gradient.addColorStop(1, secondary + '20');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, width, height);

            // Draw sample data
            ctx.strokeStyle = primary;
            ctx.lineWidth = 3;
            ctx.beginPath();

            for (let i = 0; i < 50; i++) {
                const x = (i / 49) * width;
                const y = height - (Math.sin(i * 0.2) * 0.3 + 0.5) * height;

                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }

            ctx.stroke();

            // Draw points
            ctx.fillStyle = secondary;
            for (let i = 0; i < 50; i += 5) {
                const x = (i / 49) * width;
                const y = height - (Math.sin(i * 0.2) * 0.3 + 0.5) * height;

                ctx.beginPath();
                ctx.arc(x, y, 4, 0, 2 * Math.PI);
                ctx.fill();
            }
        }

        function updateAnalyticsChart() {
            const canvas = document.getElementById('analytics-chart');
            const ctx = canvas.getContext('2d');

            if (analyticsData.length === 0) {
                return;
            }

            // Use the actual canvas dimensions (which are already scaled by DPR)
            const canvasWidth = canvas.width;
            const canvasHeight = canvas.height;


            // Clear canvas and add background
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Add chart background
            ctx.fillStyle = '#fafafa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Calculate data bounds for proper scaling
            const values = analyticsData.map(d => d.y);
            const minValue = Math.min(...values);
            const maxValue = Math.max(...values);
            const valueRange = maxValue - minValue;


            // Add padding to prevent edge clipping
            const padding = 20;
            const chartWidth = canvasWidth - (padding * 2);
            const chartHeight = canvasHeight - (padding * 2);

            // Draw chart border
            ctx.strokeStyle = '#d1d5db';
            ctx.lineWidth = 2;
            ctx.strokeRect(padding, padding, chartWidth, chartHeight);

            // Draw grid lines (more subtle)
            ctx.strokeStyle = '#f1f5f9';
            ctx.lineWidth = 1;

            // Vertical grid lines (fewer, more subtle)
            for (let i = 0; i <= 5; i++) {
                const x = padding + (i / 5) * chartWidth;
                ctx.beginPath();
                ctx.moveTo(x, padding);
                ctx.lineTo(x, canvasHeight - padding);
                ctx.stroke();
            }

            // Horizontal grid lines (fewer, more subtle)
            for (let i = 0; i <= 4; i++) {
                const y = padding + (i / 4) * chartHeight;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvasWidth - padding, y);
                ctx.stroke();
            }

            // Draw trend line first (behind points) - make it more visible
            ctx.strokeStyle = '#4c1d95';
            ctx.lineWidth = 4;
            ctx.beginPath();

            analyticsData.forEach((point, index) => {
                const x = padding + (index / (analyticsData.length - 1)) * chartWidth;
                const normalizedY = valueRange > 0 ? (point.y - minValue) / valueRange : 0.5;
                const y = canvasHeight - padding - (normalizedY * chartHeight);

                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });

            ctx.stroke();

            // Draw data points on top - make them much more visible
            analyticsData.forEach((point, index) => {
                const x = padding + (index / (analyticsData.length - 1)) * chartWidth;
                const normalizedY = valueRange > 0 ? (point.y - minValue) / valueRange : 0.5;
                const y = canvasHeight - padding - (normalizedY * chartHeight);


                // Draw point with different styles for anomalies
                if (point.isAnomaly) {
                    // Anomaly points - much larger and more visible
                    ctx.fillStyle = '#dc2626';
                    ctx.strokeStyle = '#ffffff';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.arc(x, y, 8, 0, 2 * Math.PI);
                    ctx.fill();
                    ctx.stroke();
                } else {
                    // Normal points - make them larger and more visible
                    ctx.fillStyle = '#2563eb';
                    ctx.strokeStyle = '#ffffff';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.arc(x, y, 6, 0, 2 * Math.PI);
                    ctx.fill();
                    ctx.stroke();
                }
            });

            // Draw axis labels - make them more visible
            ctx.fillStyle = '#1f2937';
            ctx.font = 'bold 13px Arial';
            ctx.textAlign = 'center';

            // X-axis labels (data points) - fewer labels for clarity
            const xStep = Math.max(1, Math.floor(analyticsData.length / 6));
            for (let i = 0; i < analyticsData.length; i += xStep) {
                const x = padding + (i / (analyticsData.length - 1)) * chartWidth;
                ctx.fillText(i.toString(), x, canvasHeight - 8);
            }

            // Y-axis labels (values) - make them more visible
            ctx.textAlign = 'right';
            ctx.font = 'bold 12px Arial';
            for (let i = 0; i <= 4; i++) {
                const value = minValue + (i / 4) * valueRange;
                const y = canvasHeight - padding - (i / 4) * chartHeight;
                ctx.fillText(value.toFixed(1), padding - 15, y + 5);
            }

            // Draw title
            ctx.fillStyle = '#2d3748';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Analytics Data Visualization', canvasWidth / 2, 15);

            // Draw legend - make it more visible
            const legendY = 35;
            const legendX = canvasWidth - 150;

            // Normal data points legend
            ctx.fillStyle = '#2563eb';
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(legendX, legendY, 6, 0, 2 * Math.PI);
            ctx.fill();
            ctx.stroke();
            ctx.fillStyle = '#1f2937';
            ctx.font = 'bold 12px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('Normal Data', legendX + 15, legendY + 4);

            // Anomaly points legend
            ctx.fillStyle = '#dc2626';
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(legendX, legendY + 25, 8, 0, 2 * Math.PI);
            ctx.fill();
            ctx.stroke();
            ctx.fillStyle = '#1f2937';
            ctx.fillText('Anomalies', legendX + 15, legendY + 29);

            // Trend line legend
            ctx.strokeStyle = '#4c1d95';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(legendX, legendY + 50);
            ctx.lineTo(legendX + 25, legendY + 50);
            ctx.stroke();
            ctx.fillText('Trend Line', legendX + 30, legendY + 54);
        }

        // Utility Functions
        function logMessage(message, level = 'info') {
            const logContainer = document.getElementById('log-container');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.innerHTML = `
                <span class="log-timestamp">[${timestamp}]</span>
                <span class="log-level-${level}">[${level.toUpperCase()}]</span> ${message}
            `;

            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;

            // Keep only last 50 entries
            while (logContainer.children.length > 50) {
                logContainer.removeChild(logContainer.firstChild);
            }
        }

        function updateSystemMetrics() {
            // Simulate system metrics
            const memory = 45 + Math.random() * 10;
            const cpu = 12 + Math.random() * 8;
            const gpu = 8 + Math.random() * 5;

            document.getElementById('system-memory').textContent = `${memory.toFixed(0)}MB`;
            document.getElementById('system-cpu').textContent = `${cpu.toFixed(0)}%`;
            document.getElementById('system-gpu').textContent = `${gpu.toFixed(0)}%`;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize charts with proper sizing
            const themedCanvas = document.getElementById('themed-chart');
            const analyticsCanvas = document.getElementById('analytics-chart');

            // Set canvas dimensions with device pixel ratio for crisp rendering
            function setupCanvas(canvas) {
                const rect = canvas.getBoundingClientRect();
                const dpr = window.devicePixelRatio || 1;

                canvas.width = rect.width * dpr;
                canvas.height = rect.height * dpr;

                const ctx = canvas.getContext('2d');
                ctx.scale(dpr, dpr);

                canvas.style.width = rect.width + 'px';
                canvas.style.height = rect.height + 'px';
            }

            setupCanvas(themedCanvas);
            setupCanvas(analyticsCanvas);

            // Draw initial charts
            drawThemedChart(themedCanvas.getContext('2d'), '#667eea', '#764ba2');

            // Initialize responsive breakpoints
            updateResponsiveBreakpoints();
            window.addEventListener('resize', function() {
                updateResponsiveBreakpoints();
                // Re-setup canvases on resize
                setupCanvas(themedCanvas);
                setupCanvas(analyticsCanvas);
                // Redraw charts
                drawThemedChart(themedCanvas.getContext('2d'), '#667eea', '#764ba2');
                if (analyticsData.length > 0) {
                    updateAnalyticsChart();
                }
            });

            // Generate initial data and ensure chart renders
            generateData();

            // Force initial chart render
            setTimeout(() => {
                updateAnalyticsChart();
            }, 200);

            // Update system metrics periodically
            setInterval(updateSystemMetrics, 2000);

            logMessage('Helios Phase 5B showcase fully initialized with enhanced chart rendering', 'info');
        });

        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.1); }
                100% { transform: scale(1); }
            }

            .theme-color {
                transition: all 0.3s ease;
            }

            .metric-card {
                transition: transform 0.2s ease;
            }

            .metric-card:hover {
                transform: translateY(-2px);
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
